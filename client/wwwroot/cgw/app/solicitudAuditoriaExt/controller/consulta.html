<section class="g-page g-page-documents">
  <div class="consulta-cotizaciones">
    <div class="g-title">
      <div class="container">
        <div class="row">
          <div class="col-sm-12 mb-xs-2 no-mb-md">
            <span class="ico-mapfre_84_circleleft ico-title"></span><h1>Consulta de Cartas para auditor externo</h1><h1 data-ng-show="vm.cartas.length>0"> ( {{vm.cartas.length}} )</h1>
          </div>
        </div>
      </div>
    </div>
    <div class="g-section-inner">
      <div class="container">
        <div class="row">
          <!-- Inicio: Filtro -->
          <div class="col-xs-12 mb-xs-2" data-ng-show="!showColSearch">
            <form action="" name="frmDocuments">
              <div show-filter class="clearfix g-col-filter g-box-md fz14 gBgcGray5-md gBgcWhite1" ng-class="{'show': isFilterVisible}">
                <div class="col-md-12 mb-ms-0 mb-xs-3 gH4 gCGray1">
                  <div id="show-filter" class="row pt-xs-2 pb-xs-2 gBgcGray5 g-border-bottom-xs hidden-md hidden-lg" ng-click="toggleFilter();">
                    <div class="col-xs-10"><h2><b>Filtro</b></h2></div>
                    <div class="col-xs-2 g-text-right-xs">
                      <span class="glyphicon glyphicon-chevron-down" ng-if="isFilterVisible"></span>
                      <span class="glyphicon glyphicon-chevron-up" ng-if="!isFilterVisible"></span>
                    </div>
                    <div class="clearfix"></div>
                  </div>
                </div>
                <div class="g-col-filter__box">
                  <div class="col-md-12">
                    <div class="row">                     
                      <div class="col-md-3 mb-xs-2">
                        <div class="input-group g-date-picker">
                          <label class="g-placeholder animated ng-binding">Desde:</label>
                          <input  type="text"
                                  class="form-control"
                                  uib-datepicker-popup="{{vm.format}}"
                                  data-ng-model="vm.formData.mConsultaDesde"
                                  is-open="vm.popup1.opened"
                                  datepicker-options="vm.dateOptions"
                                  data-ng-required="true"
                                  close-text="Close"
                                  alt-input-formats="altInputFormats"
                                  placeholder="Desde" />
                          <span class="input-group-btn">
                            <button type="button"
                                    class="btn btn-default"
                                    data-ng-click="vm.open1()">
                              <i class="glyphicon glyphicon-calendar"></i>
                            </button>
                          </span>
                        </div>
                      </div>
                      <div class="col-md-3 mb-xs-2">
                        <div class="input-group g-date-picker">
                          <label class="g-placeholder animated ng-binding">Hasta:<span ng-show="false" class="ng-hide" style="">*</span></label>
                          <input  type="text"
                                  class="form-control"
                                  uib-datepicker-popup="{{vm.format}}"
                                  data-ng-model="vm.formData.mConsultaHasta"
                                  is-open="vm.popup2.opened"
                                  datepicker-options="vm.dateOptions2"
                                  data-ng-required="true"
                                  close-text="Close"
                                  alt-input-formats="vm.altInputFormats"
                                  placeholder="Hasta" />
                          <span class="input-group-btn">
                            <button type="button"
                                    class="btn btn-default"
                                    data-ng-click="vm.open2()">
                              <i class="glyphicon glyphicon-calendar"></i>
                            </button>
                          </span>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-12">
                    <div class="row">                     
                      <div class="col-md-3 mb-xs-2">
                        <mpf-select data-ng-model="vm.formData.mEmpresa"
                                    name="nEmpresa"
                                    label="{label: 'Empresa', required: false}"
                                    m-data-source="vm.empresas"
                                    text-field="description"
                                    value-field="code"
                                    m-Empty-Option="{enterData:false}"
                                    mpf-validation="required"></mpf-select>
                      </div>
                      <div class="col-md-3 mb-xs-2">
                        <mpf-input  label="{label: 'Nro. de Carta', required: false}"
                                    name="nNroCarta"
                                    data-ng-model="vm.formData.mNroCarta"
                                    mpf-validation="onlyNumber"
                                    data-ng-required="false"></mpf-input>
                      </div>
                      <div class="col-md-3 mb-xs-2">
                        <mp-data-seeker
                                    behavior="{label:'Clínica', placeholder:'Ingresa nombre de la clínica...', matchField:'description'}"
                                    m-data-source="vm.getListClinic($inputNeed)"
                                    ng-model="vm.formData.mClinica"
                                    name="nClinica"
                                    ng-required="false"
                                    ng-change="vm.saveClinic(mClinica)">
                          <div ng-bind-html="$item.description | highlight: $select.search"></div>
                        </mp-data-seeker>
                      </div>
                      <div class="col-md-3 mb-xs-2">
                        <mpf-input  label="{label: 'Nro. Afiliado', required: false}"
                                    name="nNroAfiliado"
                                    data-ng-model="vm.formData.mNroAfiliado"
                                    data-ng-required="false"
                                    mpf-validation="onlyNumber"
                                    ></mpf-input>
                      </div>
                      <div class="col-md-3 mb-xs-2">
                        <mpf-input  label="{label: 'Apellido Paterno', required: false}"
                                    name="nApePaterno"
                                    data-ng-model="vm.formData.mApePaterno"
                                    mpf-validation="onlyLetter"
                                    data-ng-required="false"></mpf-input>
                      </div>
                      <div class="col-md-3 mb-xs-2">
                        <mpf-input  label="{label: 'Apellido Materno', required: false}"
                                    name="nApeMaterno"
                                    mpf-validation="onlyLetter"
                                    data-ng-model="vm.formData.mApeMaterno"
                                    data-ng-required="false"></mpf-input>
                      </div>
                      <div class="col-md-3 mb-xs-2">
                        <mpf-input  label="{label: 'Nombres', required: false}"
                                    name="nNombre"
                                    mpf-validation="onlyLetter"
                                    data-ng-model="vm.formData.mNombre"
                                    data-ng-required="false"></mpf-input>
                      </div>
                    </div>  
                  </div>
                  <div class="col-md-12">
                    <div class="row">                      
                      <div class="col-md-3 mb-xs-2">
                        <mpf-select data-ng-model="vm.formData.mEstadoAuditoria"
                                    name="nEjecutivo"
                                    label="{label: 'Estado Auditoría Externa', required: false}"
                                    m-data-source="vm.estadoCartas"
                                    text-field="description"
                                    value-field="id"
                                    m-Empty-Option="{enterData:true}"></mpf-select>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-12">
                    <div class="row">  
                      <div class="col-md-3 col-md-offset-3 mb-xs-1">
                        <button class="g-btn g-btn-verde block" data-ng-click="vm.filtrar()" ng-disabled="disabledButton" prevent-default>Filtrar</button>
                      </div>
                      <div class="col-md-3">
                        <a class="g-btn g-btn-white block" data-ng-click="vm.limpiar()">Limpiar</a>
                      </div>
                    </div>
                  </div>    
                </div>  
              </div>
            </form>
          </div>

          <div class="clearfix">
            <div class="col-md-12">
              <div class="clearfix g-tbl-wrapper">
                <div class="clearfix table__1170">
                  <ul height-row class="g-row-fz12 g-tbl-row gBgcGray5 pt-xs-1">
                    <li class="g-col g-col-xs col-5-dktp tbl-item item-title text-center">VER</li>
                    <li class="g-col g-col-xs col-7-dktp tbl-item item-title">CARTAS</li>
                    <li class="g-col g-col-xs col-11-dktp tbl-item item-title text-center">ESTADO</li>
                    <li class="g-col g-col-xs col-5-dktp tbl-item item-title">AÑO</li>
                    <li class="g-col g-col-xs col-8-dktp tbl-item item-title text-center">VERSION</li>
                    <li class="g-col g-col-xs col-9-dktp tbl-item item-title text-right">MONTO (S/)</li>
                    <li class="g-col g-col-xs col-10-dktp tbl-item item-title">INGRESO</li>
                    <li class="g-col g-col-xs col-14-dktp tbl-item item-title">CLIENTE</li>
                    <li class="g-col g-col-xs col-14-dktp tbl-item item-title">ASEGURADO</li>
                    <li class="g-col g-col-xs col-8-dktp tbl-item item-title text-center">NRO. A.E.</li>
                    <li class="g-col g-col-xs col-8-dktp tbl-item item-title text-center">PRODUCTO</li>
                  </ul>
                  <div class="mb-xs-1">
                    <ul height-row class="g-row-fz12 g-tbl-row pt-xs-1 g-border-bottom-xs" data-ng-repeat="carta in vm.cartas" ang-if="!noResult">
                      <li class="g-col g-col-xs col-5-dktp tbl-item gCGray3 text-center">
                        <a href="" ng-click="vm.verDetalle(carta)">
                          <span class="gnIcon-md ico-mapfre_236_vercontrasena"></span>
                        </a>
                      </li>
                      <li class="g-col g-col-xs col-7-dktp tbl-item"><span class="cgw_report-label">{{carta.number}}<br>{{carta.productName}}</span></li>
                      <li class="g-col g-col-xs col-11-dktp tbl-item">
                        <span class="mb-xs-1 mb-md-0">{{carta.statusExternalAudit}}</span>
                      </li>
                      <li class="g-col g-col-xs col-5-dktp tbl-item text-center"><span class="cgw_report-label">{{carta.year}}</span></li>
                      <li class="g-col g-col-xs col-8-dktp tbl-item text-center"><span class="cgw_report-label">{{carta.version}}</span></li>
                      <li class="g-col g-col-xs col-9-dktp tbl-item text-right"><span class="cgw_report-label">{{carta.requestedAmount | currency}}</span></li>
                      <li class="g-col g-col-xs col-10-dktp tbl-item"><span class="cgw_report-label">{{carta.dateRequested}}</span></li>
                      <li class="g-col g-col-xs col-14-dktp tbl-item"><span class="cgw_report-label">{{carta.client}}</span></li>
                      <li class="g-col g-col-xs col-14-dktp tbl-item"><span class="cgw_report-label">{{carta.patientFullName}}</span></li>
                      <li class="g-col g-col-xs col-8-dktp tbl-item text-center"><span class="cgw_report-label">{{carta.externalAuditNumber}}</span></li>
                      <li class="g-col g-col-xs col-8-dktp tbl-item text-center"><span class="cgw_report-label">{{carta.codeProduct}}</span></li>
                    </ul>
                  </div>
                </div>
              </div>
              <div class="row g-text-center-xs g-box-noresult" ng-if="false">
                <div class="col-md-12 g-box-noresult-ico gCBlue2">
                  <span class="ico-mapfre_303_informacion"></span>
                </div>
                <div class="col-md-12 g-box-noresult-text">
                  Realiza una búsqueda para obtener resultados.
                </div>
              </div>
            </div>
          </div>

          <div class="resultado-col col-md-12">
            <div class="row" ng-if="vm.cartas.length>0">
              <div class="col-md-12">
                <ul uib-pagination class="g-pagination" data-ng-model="mPagination" max-size="10" total-items="totalItems" data-ng-change="pageChanged(mPagination)" boundary-link-numbers="true"></ul>
              </div>
            </div>

            <div class="col-md-12 text-center g-box-noresult" data-ng-hide="vm.cartas.length>0">
              <div class="row">
                <div class="col-md-12 g-box-noresult-ico gCRed1"><span class="ico-mapfre_302_error"></span></div>
                <div class="col-md-12 g-box-noresult-text">No hay resultados para los filtros escogidos.<br>Intente nuevamente.</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>