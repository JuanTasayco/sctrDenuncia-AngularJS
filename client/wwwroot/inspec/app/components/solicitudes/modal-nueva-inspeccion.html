<section class="g-page page-modal page-modal__nueva-inspeccion">
  <button type="button" class="close g-close-modal" ng-click="$ctrl.closeModal()">
    <span class="ico-mapfre_231_cancelaroff"></span>
  </button>
  <form name="$ctrl.formData">
    <div class="row">
      <div class="col-md-12">
        <div class="g-text-center-xs mb-xs-2">
          <h2 class="gH3"><b>NUEVA INSPECCIÓN</b></h2>
        </div>
        <div class="modal-body">
          <div class="row">
            <div class="col-md-12">
              <h2 class="gH4 gCGray1 g-border-bottom-xs"><b>Cotización previa</b></h2>
            </div>
          </div>
          <div class="g-border-bottom mb-xs-2"></div>
          <div class="row mb-xs-2">
            <div class="col-md-5 mb-xs-2">
              <m-radio ng-model="$ctrl.optCotizacionPrevia" name="optCotizacionPrevia" label="{ label: 'Cuenta con una cotización previa' }" value="1"></m-radio>
            </div>
            <div class="col-md-5 mb-xs-2">
              <m-radio ng-model="$ctrl.optCotizacionPrevia" name="optCotizacionPrevia" label="{ label: 'No cuenta con una cotización previa' }" value="0"></m-radio>
            </div>
          </div>
          <div class="row">
            <div class="col-md-12">
              <h2 class="gH4 gCGray1 g-border-bottom-xs"><b>Datos para notificación</b></h2>
            </div>
          </div>
          <div class="g-border-bottom mb-xs-2"></div>
          <div class="row">
            <div class="col-md-4 mb-xs-2">
              <mpf-select label="{label: 'Notificar', required: false}" ng-model="$ctrl.mNotificarA" name="nNotificarA" m-data-source="$ctrl.notificarAData" ng-disabled="!$ctrl.user.isAPermittedObject('MODAGE') && !$ctrl.user.isAPermittedObject('SINEMI')"></mpf-select>
            </div>
          </div>
          <div class="row mb-xs-2" ng-if="$ctrl.mNotificarA.Codigo === '0'">
            <div class="col-md-4 mb-xs-2">
              <mp-data-seeker behavior="{label:'Agente *', matchField:'CodigoNombre', placeholder: 'Ingresa nombre o código de agente'}" m-data-source="$ctrl.queryAgents($inputNeed)" ng-model="$ctrl.formData.mAgent" name="nAgent" ng-required="true" ng-change="$ctrl.queryUser()">
                <div ng-bind-html="$item.CodigoNombre | highlight: $select.search"></div>
              </mp-data-seeker>
              <div class="g-error" ng-show="$ctrl.formData.nAgent.$invalid && !$ctrl.formData.nAgent.$pristine">* Ingrese un agente</div>
            </div>
            <div class="col-md-4 mb-xs-2">
              <mpf-select label="{label: 'Usuario OIM', required: true}" ng-model="$ctrl.formData.mUserOIM" name="nUserOIM" m-data-source="$ctrl.userOIMData" mpf-validation="required" m-Empty-Option="{enterData:true}" text-field="username" value-field="userid" ng-change="$ctrl.setEmail()"></mpf-select>
              <div class="g-error" ng-show="$ctrl.formData.nUserOIM.$invalid && !$ctrl.formData.nUserOIM.$pristine">* Ingrese un usuario</div>
            </div>
            <div class="col-md-4 mb-xs-2">
              <mpf-input label="{label: 'Email confirmación', required: false}" name="nEmailConfirm" ng-model="$ctrl.formData.mEmailConfirm" mpf-validation="required,email"></mpf-input>
              <div class="g-error" ng-show="$ctrl.formData.nEmailConfirm.$invalid && !$ctrl.formData.nEmailConfirm.$pristine">* Ingrese un correo</div>
            </div>
            <div class="col-md-4 mb-xs-2">
              <mpf-input label="{label: 'Email copia', required: false}" name="nEmailCopia" ng-model="$ctrl.formData.mEmailCopia"></mpf-input>
            </div>
          </div>
          <div class="row mb-xs-2" ng-if="$ctrl.mNotificarA.Codigo !== '0'">
            <div class="col-md-8 mb-xs-2">
              <mpf-select label="{label: 'Coordinador', required: false}" name="nCoordinador" ng-model="$ctrl.mCoordinador" m-data-source="$ctrl.coordinators" text-field="userfullname" value-field="userid"></mpf-select>
              <div class="g-error" ng-show="$ctrl.formData.nCoordinador.$invalid && !$ctrl.formData.nCoordinador.$pristine">* Ingrese un coordinador</div>
            </div>
          </div>
          <div class="row">
            <div class="col-xs-12 clearfix">
              <div class="row">
                <div class="col-sm-4 col-sm-offset-2 mb-xs-1"><a class="g-btn g-btn-white block" ng-click="$ctrl.closeModal()">Cancelar</a></div>
                <div class="col-sm-4"><a class="g-btn g-btn-verde block" ng-click="$ctrl.nextStep()">Registrar inspección</a></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </form>
</section>
