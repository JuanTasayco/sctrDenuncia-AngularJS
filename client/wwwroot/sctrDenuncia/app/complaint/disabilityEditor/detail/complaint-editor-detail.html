<div id="form-views" class="g-complaint-detail">
    <form name="frmComplaintDetail">
        <div class="sec-auto g-section-inner">
            <div class="container">
                <div class="row">
                    <div class="col-md-12 mb-1">
                        <h2 class="g-sub-title">Datos del Asegurado</h2>
                    </div>
                    <div class="col-md-6 mb-xs-2">
                        <mpf-input label="{label: 'DNI / Nombre y Apellidos', required: false}"
                            ng-model="$ctrl.viewdata.nombreCompleto" 
                            ng-disabled="true" 
                            name="nNameComplete">
                        </mpf-input>
                    </div>
                    <div class="col-md-2 mb-xs-2">
                        <mpf-input label="{label: 'Sexo', required: false}" 
                            ng-model="$ctrl.viewdata.genero"
                            ng-disabled="true" 
                            name="nGender"></mpf-input>
                    </div>
                    <div class="col-md-2 mb-xs-2">
                        <mpf-datepicker label="{label: 'Fecha de nacimiento', required: false}" 
                            name="nBirthday"
                            format="'dd/MM/yyyy'" 
                            data-maxDate="$ctrl.currentDate"
                            ng-model="$ctrl.viewdata.fecNacimiento" 
                            ng-disabled="true" 
                            nomargin="true"></mpf-datepicker>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12 mb-1">
                        <h3 class="g-sub-title c-black denuncia">Datos de contacto</h3>
                    </div>
                    <div class="col-md-2 mb-xs-2">
                        <mpf-input label="{label: 'Télefono móvil', required: false}"
                            ng-model="$ctrl.viewdata.telefono" 
                            name="nInsuredPhone"
                            ng-model-options="{allowInvalid: true}" 
                            ng-minlength="7" 
                            ng-maxlength="9" 
                            mpf-validation="onlyNumberNoSpace"
                            ng-disabled="$ctrl.showDetail"></mpf-input>

                        <div class="g-error"
                            ng-show="(frmComplaintDetail.nInsuredPhone.$invalid && !frmComplaintDetail.nInsuredPhone.$pristine)">
                            * El número de teléfono debe tener mínimo 7 dígitos
                        </div>
                    </div>
                    <div class="col-md-4 mb-xs-2">
                        <mpf-input label="{label: 'Correo electrónico', required: false}"
                            ng-model="$ctrl.viewdata.email" 
                            name="nInsuredEmail" 
                            mpf-validation="email" 
                            ng-model-options="{allowInvalid: true}"
                            ng-disabled="$ctrl.showDetail">
                        </mpf-input>

                        <div class="g-error" 
                            ng-show="(frmComplaintDetail.nInsuredEmail.$invalid && !frmComplaintDetail.nInsuredEmail.$pristine)">
                            * Ingresar un formato válido de correo electrónico
                        </div>
                    </div>
                    <div class="col-md-2 mb-xs-2">
                        <mpf-datepicker label="{label: 'Fecha de siniestro', required: false}"
                            name="nSinisterDate" 
                            format="'dd/MM/yyyy'" 
                            data-maxDate="$ctrl.currentDate"
                            ng-model="$ctrl.viewdata.fecAccidente" 
                            ng-disabled="true"
                            nomargin="true">
                        </mpf-datepicker>
                    </div>
                    <div class="col-md-8 mb-xs-2">
                        <mp-data-seeker name="nClinic" ng-required="true" ng-disabled="true"
                            behavior="{label:'Clínica', matchField:'fulltext', placeholder: 'Ingresa la clínica'}"
                            m-data-source="$ctrl.seekClinic($inputNeed)" ng-model="$ctrl.viewdata.clinic">
                            <div ng-bind-html="$item.fulltext | highlight: $select.search"></div>
                        </mp-data-seeker>

                        <div class="g-error"
                            ng-show="frmComplaintDetail.nClinic.$error.required && !frmComplaintDetail.nClinic.$pristine">
                            * Seleccione una clínica</div>
                    </div>
                </div>                
                <div class="row">
                    <div class="col-md-12 mb-1">
                        <h2 class="g-sub-title">Datos de la Póliza</h2>
                    </div>
                    <div class="col-md-2 mb-xs-2">
                        <mpf-input label="{label: 'Tipo de Póliza', required: false}"
                            ng-model="$ctrl.viewdata.tipoPoliza" 
                            ng-disabled="true" 
                            name="nTipoPoliza"></mpf-input>
                    </div>
                    <div class="col-md-4 mb-xs-2">
                        <mpf-input label="{label: 'No de póliza', required: false}"
                            ng-model="$ctrl.viewdata.numeroPoliza" 
                            ng-disabled="true" 
                            name="nNoPoliza"></mpf-input>
                    </div>
                    <div class="col-md-4 mb-xs-2">
                        <mpf-input label="{label: 'Vigencia de la póliza', required: false}"
                            ng-model="$ctrl.viewdata.vigencia" 
                            ng-disabled="true" 
                            name="nVigenciaPoliza"></mpf-input>
                    </div>
                    <div class="col-md-2 mb-xs-2">
                        <mpf-input label="{label: 'No. de plan', required: false}" 
                            ng-model="$ctrl.viewdata.nroPlan"
                            ng-disabled="true" 
                            name="nNoPlan"></mpf-input>
                    </div>

                </div>
                <div class="row">
                    <div class="col-md-12 mb-1">
                        <h2 class="g-sub-title">Datos del Cliente</h2>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6 mb-xs-2">
                        <mpf-input label="{label: 'RUC / Nombre o Razón social', required: false}"
                            ng-model="$ctrl.viewdata.nombresCliente" 
                            ng-disabled="true" 
                            ng-required="false"
                            name="nNombresCliente"></mpf-input>
                    </div>
                    <div class="col-md-2 mb-xs-2">
                        <mpf-input label="{label: 'Teléfono', required: false}"
                            ng-model="$ctrl.viewdata.telefonoCliente" 
                            ng-disabled="true" 
                            ng-required="false"
                            name="nTelefonoCliente"></mpf-input>
                    </div>
                    <div class="col-md-4 mb-xs-2">
                        <mpf-input label="{label: 'Correc electrónico', required: false}"
                            ng-model="$ctrl.viewdata.correoCliente" 
                            ng-disabled="true" 
                            ng-required="false"
                            name="nEmailDenuncia"></mpf-input>
                    </div>
                </div>
            </div>
            <div class="container g-managment-documents">
                <div class="row">
                    <div class="col-md-12 mb-1">
                        <h2 class="g-sub-title">Documentos</h2>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-4 mb-xs-2">
                        <mpf-Select text-field="descripcion" 
                                    value-field="codigo" 
                                    label="{label: 'Documento Solicitado', required: false}" 
                                    m-data-source="$ctrl.documentosSolicitados" 
                                    ng-model="$ctrl.data.documentoSolicitado" 
                                    name="mDocumentoSolicitado" 
                                    m-Empty-Option="{enterData:true}"
                                    ng-disabled="$ctrl.showDetail"></mpf-Select>
                        </mpf-Select>
                    </div>
                    <div class="col-md-3 mb-xs-2">
                        <div class="col-xs-9">
                            <mpf-input label="{label: 'Seleccionar Documento', required: false}" ng-disabled="true" 
                            ng-model="$ctrl.data.file[0].name"  name="nFilename" ></mpf-input>
                        </div>
                        <div class="col-xs-3 file-field">
                            <div class="file-field">
                                <div class="btn btn-primary float-left"
                                    ng-class="$ctrl.isEndStatus() ? 'disabled' : ''">
                                    <span>Buscar</span>
                                    <input file-model="$ctrl.data.file" type="file"
                                    accept=".jpg, .jpeg, .png, .gif, .bmp, .pdf, .doc, .xls,.docx, .xlsx, .txt" 
                                    ng-disabled="$ctrl.showDetail">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-5 mb-xs-2">
                        <div class="col-xs-12 col-md-offset-6 col-md-6 mt-md-2 mb-md-2 mt-xs-1 mb-xs-1">
                            <a class="g-btn g-btn-white second-design block"
                                ng-class="$ctrl.showDetail ? 'disabled' : ''"
                                ng-disabled="$ctrl.showDetail"
                                ng-click="$ctrl.appendDocument()">Cargar</a>
                        </div>
                    </div>
                </div>
                <div>
                    <div ng-repeat="doc in $ctrl.documents" class="row item">
                        <div class="col-md-12 mb-xs-2 clearfix g-box">
                            <div class="row g-box-content">
                                <div class="col-md-11">
                                    <b>{{ doc.descripcionTipoDocumento }}</b>
                                    <br>
                                    <span>{{ doc.nombreArchivo }}</span>
                                </div>
                                <div class="col-md-1 buttons">
                                    <a title="Descargar archivo" ng-click="$ctrl.downloadDocument(doc)" ng-show="doc.opt !== 1">
                                        <i class="glyphicon glyphicon-download-alt"></i>
                                    </a>
                                    <a title="Borrar archivo" ng-click="$ctrl.deleteDocument(doc, $index)"
                                        ng-class="$ctrl.showDetail ? 'disabled' : ''"
                                        ng-disabled="$ctrl.showDetail">
                                        <i  class="glyphicon glyphicon-trash"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row" ng-show="$ctrl.paginationDoc.totalRecords > $ctrl.paginationDoc.sizePerPage">
                        <div class="col-md-12">
                            <ul uib-pagination class="g-pagination" ng-model="$ctrl.paginationDoc.currentPage"
                                max-size="$ctrl.paginationDoc.maxSize" total-items="$ctrl.paginationDoc.totalRecords"
                                ng-change="$ctrl.pageChangedDocs()" items-per-page="$ctrl.paginationDoc.sizePerPage"
                                boundary-link-numbers="true"></ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container">
                <div class="row">
                    <div class="col-md-12 mb-1">
                        <h2 class="g-sub-title">Datos COMEPS</h2>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-4 mb-xs-2">
                        <div class="mb-xs-2">
                            <b>¿Envío COMEPS?</b>
                        </div>
                        <div class="col-md-6 mb-xs-2 indi-container">
                            <m-radio 
                                label="{label: 'Si'}" 
                                name="mSendComeps" 
                                ng-model="$ctrl.viewdata.sendComeps"
                                value="S"
                                ng-required="false"
                                ng-disabled="$ctrl.showDetail">
                            </m-radio>
                        </div>
                        <div class="col-md-6 mb-xs-2 indi-container">
                            <m-radio 
                                label="{label: 'No'}" 
                                name="mSendComeps" 
                                ng-model="$ctrl.viewdata.sendComeps"
                                value="N" 
                                ng-required="false"
                                ng-disabled="$ctrl.showDetail">
                            </m-radio>
                        </div>
                    </div>
                    <div class="col-md-4 mb-xs-2">
                        <mpf-datepicker label="{label: 'Fecha de envío a COMEPS', required: false}"
                            name="nSendDate" format="'dd/MM/yyyy'" data-maxDate="$ctrl.currentDate"
                            ng-model="$ctrl.viewdata.sendDate" nomargin="true" ng-disabled="$ctrl.showDetail">
                        </mpf-datepicker>
                    </div>
                    <div class="col-md-4 mb-xs-2">
                        <mpf-datepicker label="{label: 'Fecha de respuesta a COMEPS', required: false}"
                            name="nReceiveDate" format="'dd/MM/yyyy'" data-maxDate="$ctrl.currentDate"
                            ng-model="$ctrl.viewdata.receiveDate" nomargin="true" ng-disabled="$ctrl.showDetail">
                        </mpf-datepicker>
                    </div>
                </div>
            </div>
            <div class="container">
                <div class="row">
                    <div class="col-md-12 mt-xs-2">
                        <b>Ahorro estimado:</b>
                    </div>

                    <div class="col-md-4 mb-xs-2">
                        <mpf-Select 
                            text-field="descripcion" 
                            value-field="codigo"
                            m-data-source="$ctrl.tiposMonedas" 
                            ng-model="$ctrl.viewdata.estimateMoneyType"
                            name="mEstimateMoneyType" 
                            ng-disabled="$ctrl.showDetail"
                            m-Empty-Option="{enterData:true}"></mpf-Select>
                    </div>

                    <div class="col-md-4 mb-xs-2">
                        <mpf-input 
                            ng-model="$ctrl.viewdata.estimatedAmount"
                            ng-disabled="$ctrl.showDetail"
                            mpf-validation="onlyNumberDecimal"
                            name="nEstimatedAmount"></mpf-input>
                    </div>
                </div>
            </div>
            <div class="container mt-xs-4">
                <div class="row">
                    <div class="col-md-10 mb-1">
                        <h2 class="g-sub-title">Comentarios</h2>
                    </div>
                    <div class="col-md-2 mb-xs-2">
                        <a class="g-btn g-btn-white second-design block"
                            ng-class="$ctrl.showDetail ? 'disabled' : ''"
                            ng-disabled="$ctrl.showDetail"
                            ng-click="$ctrl.addComment()">Agregar comentario</a>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12 mb-xs-2">
                        <mpf-textarea 
                            name="nComment" 
                            ng-required="false" 
                            label="{label: 'Observación', required: false}" 
                            ng-model="$ctrl.data.comment"
                            ng-disabled="$ctrl.showDetail">
                        </mpf-textarea>
                    </div>
                </div>
                <div class="row mt-xs-4">
                    <div ng-repeat="comment in $ctrl.comments" class="clearfix g-box g-overflow-hidden-xs mb-xs-2">
                        <div class="pt-xs-1 pb-xs-1 gBgcGray5">
                            <ul class="row clearfix g-list second-design">
                                <li class="col-md-7 clearfix">
                                    <div class="col-xs-12 ">
                                        <span>Comentario</span>
                                    </div>
                                </li>
                                <li class="col-md-2 clearfix">
                                    <div class="col-xs-12 ">
                                        <span>Usuario</span>
                                    </div>
                                </li>
                                <li class="col-md-2 clearfix">
                                    <div class="col-xs-12 ">
                                        <span>Fecha y hora</span>
                                    </div>
                                </li>
                                <li class="col-md-1 clearfix"></li>
                            </ul>
                            <ul class="row clearfix g-list second-design">
                                <li class="col-md-7 clearfix">
                                    <div class="col-xs-12 ">
                                        <b>{{ comment.comentario }}</b>
                                    </div>
                                </li>
                                <li class="col-md-2 clearfix">
                                    <div class="col-xs-12 ">
                                        <b>{{ comment.codigoUsuario }}</b>
                                    </div>
                                </li>
                                <li class="col-md-2 clearfix">
                                    <div class="col-xs-12 ">
                                        <b>{{ comment.fechaCreacion | date :'dd/MM/yyyy h:mm a' }}</b>
                                    </div>
                                </li>
                                <div class="col-md-1 buttons">
                                    <a title="Borrar comentario" ng-click="$ctrl.deleteComment(comment, $index)"
                                        ng-class="$ctrl.showDetail ? 'disabled' : ''"
                                        ng-disabled="$ctrl.showDetail"
                                        ng-show="comment.opt === 1">
                                        <i class="glyphicon glyphicon-trash"></i>
                                    </a>
                                </div>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="row" ng-show="$ctrl.paginationCom.totalRecords > $ctrl.paginationCom.sizePerPage">
                    <div class="col-md-12">
                        <ul uib-pagination class="g-pagination" ng-model="$ctrl.paginationCom.currentPage"
                            max-size="$ctrl.paginationCom.maxSize" total-items="$ctrl.paginationCom.totalRecords"
                            ng-change="$ctrl.pageChangedComs()" items-per-page="$ctrl.paginationCom.sizePerPage"
                            boundary-link-numbers="true"></ul>
                    </div>
                </div>
            </div>
            <div class = "container">
                <div class="row">
                    <div class="col-xs-12 col-md-offset-8 col-md-2 mt-md-2 mb-md-2 mt-xs-1 mb-xs-1">
                        <a class="g-btn g-btn-white second-design block"
                        ui-sref="complaint.disabilitySearch">Cancelar</a>
                    </div>

                    <div class="col-xs-12 col-md-2 mt-md-2 mb-md-2 mt-xs-1 mb-xs-1">
                        <a class="g-btn g-btn-verde second-design block"
                        ng-class="$ctrl.showDetail ? 'disabled' : ''"
                        ng-disabled="$ctrl.showDetail"
                        ng-click="$ctrl.guardarSolicitud()">Guardar</a>
                    </div>
                </div>
            </div>
        </div>
    </form>
</div>