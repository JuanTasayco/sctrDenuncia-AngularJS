<!-- Step 5 -->
<form action="" name="frmEmitU5">

  <div class="g-section-inner">
    <div class="container">

      <div class="row">
        <div class="col-md-12">
          <h2 class="g-sub-title">Datos del Gestor de Cobro <span ng-hide="mainStep.IS_REQUIRED_RC">(opcional)</span></h2>
        </div>
      </div>
      <div class="row">
        <div class="col-md-4">
          <div class="row">
            <div class="col-md-6 mb-xs-2">
              <m-radio
                label="{label: 'Registro de cuenta'}"
                name="nRegistro"
                ng-model="fiveStep.registro"
                value="DB"
                ng-click="clearCollectionManager(fiveStep.registro, true)">
              </m-radio>
            </div>
            <div class="col-md-6 mb-xs-2">
              <m-radio
                label="{label: 'Registro de tarjeta'}"
                name="nRegistro"
                ng-model="fiveStep.registro"
                value="TA"
                ng-click="clearCollectionManager(fiveStep.registro, true)">
              </m-radio>
            </div>
          </div>
        </div>
      </div>
      <div class="row" ng-if="isRegistroCuenta()">
        <div class="col-md-4 mb-xs-2">
          <mpf-select
            label="{label: 'Entidad', required: mainStep.IS_REQUIRED_RC}"
            name="nEntidad"
            ng-model="fiveStep.entidad"
            text-field="Descripcion"
            value-field="Codigo"
            m-data-source="entidades"
            m-Empty-Option="{enterData:true}"
            ng-change="onEntidadChange(fiveStep.entidad)"
            ng-required="mainStep.IS_REQUIRED_RC">
          </mpf-select>
          <ul class="g-error">
            <li ng-show="frmEmitU5.nEntidad.$invalid && !frmEmitU5.nEntidad.$pristine">* Este campo es requerido</li>
          </ul>
        </div>
        <div class="col-md-4 mb-xs-2">
          <mpf-input
            label="{label: 'Oficina', required: mainStep.IS_REQUIRED_RC}"
            name="nOficina"
            ng-model="fiveStep.oficina"
            ng-required="mainStep.IS_REQUIRED_RC"
            ng-disabled="true">
          </mpf-input>
          <ul class="g-error">
            <li ng-show="frmEmitU5.nOficina.$invalid && !frmEmitU5.nOficina.$pristine">* Este campo es requerido</li>
          </ul>
        </div>
        <div class="col-md-4 mb-xs-2">
          <mpf-select
            label="{label: 'Tipo de cuenta', required: mainStep.IS_REQUIRED_RC}"
            name="nTipoCuenta"
            ng-model="fiveStep.tipoCuenta"
            text-field="Descripcion"
            value-field="Codigo"
            m-data-source="tipoCuentas"
            m-Empty-Option="{enterData:true}"
            ng-required="mainStep.IS_REQUIRED_RC">
          </mpf-select>
          <ul class="g-error">
            <li ng-show="frmEmitU5.nTipoCuenta.$invalid && !frmEmitU5.nTipoCuenta.$pristine">* Este campo es requerido</li>
          </ul>
        </div>
      </div>
      <div class="row" ng-if="isRegistroCuenta()">
        <div class="col-md-4 mb-xs-2">
          <mpf-select
            label="{label: 'Moneda', required: mainStep.IS_REQUIRED_RC}"
            name="nMoneda"
            ng-model="fiveStep.moneda"
            text-field="Descripcion"
            value-field="Codigo"
            m-data-source="monedas"
            m-Empty-Option="{enterData:true}"
            ng-required="mainStep.IS_REQUIRED_RC">
          </mpf-select>
          <ul class="g-error">
            <li ng-show="frmEmitU5.nMoneda.$invalid && !frmEmitU5.nMoneda.$pristine">* Este campo es requerido</li>
          </ul>
        </div>
        <div class="col-md-4 mb-xs-2">
          <mpf-input
            label="{label: 'Cta calcular', required: mainStep.IS_REQUIRED_RC}"
            name="nCalcular"
            ng-model="fiveStep.ctaCalcular"
            ng-maxlength="fiveStep.maxCuenta"
            mpf-validation="onlyNumber"
            ng-required="mainStep.IS_REQUIRED_RC"
            ng-blur="onCtaCalcular(fiveStep.ctaCalcular)">
          </mpf-input>
          <ul class="g-error">
            <li ng-show="frmEmitU5.nCalcular.$invalid && !frmEmitU5.nCalcular.$pristine">* Este campo es requerido</li>
          </ul>
        </div>
        <div class="col-md-4 mb-xs-2">
          <mpf-input
            label="{label: 'Cuenta', required: mainStep.IS_REQUIRED_RC}"
            name="nCuenta"
            ng-model="fiveStep.cuenta"
            mpf-validation="onlyLetterNumber"
            ng-maxlength="100"
            ng-required="mainStep.IS_REQUIRED_RC"
            ng-disabled="true">
          </mpf-input>
          <ul class="g-error">
            <li ng-show="frmEmitU5.nCuenta.$invalid && !frmEmitU5.nCuenta.$pristine">* Este campo es requerido</li>
          </ul>
        </div>
      </div>
      <div class="row" ng-if="isRegistroCuenta()">
        <div class="col-md-4">
          <mpf-select
            label="{label: 'Código gestor', required: mainStep.IS_REQUIRED_RC}"
            name="nCodigoGestorEn"
            ng-model="fiveStep.codigoGestorEn"
            m-data-source="fiveStep.codigoGestoresEn"
            text-field="Descripcion"
            value-field="Codigo"
            m-Empty-Option="{enterfiveStep:true}"
            ng-required="mainStep.IS_REQUIRED_RC" >
          </mpf-select>
          <ul class="g-error">
            <li ng-show="frmEmitU5.nCodigoGestorEn.$invalid && !frmEmitU5.nCodigoGestorEn.$pristine">* Este campo es requerido</li>
          </ul>
        </div>
      </div>
      <div class="row" ng-if="isRegistroTarjeta()">
        <div class="col-md-4 mb-xs-2">
          <mpf-select
            label="{label: 'Tipo de tarjeta', required: mainStep.IS_REQUIRED_RT}"
            name="nTipoTarjeta"
            ng-model="fiveStep.tipoTarjeta"
            text-field="Descripcion"
            value-field="Codigo"
            m-data-source="tipoTarjetas"
            ng-change="onTipoTarjetaChange(fiveStep.tipoTarjeta)"
            m-Empty-Option="{enterData:true}"
            ng-required="mainStep.IS_REQUIRED_RT">
          </mpf-select>
          <ul class="g-error">
            <li ng-show="frmEmitU5.nTipoTarjeta.$invalid && !frmEmitU5.nTipoTarjeta.$pristine">* Este campo es requerido</li>
          </ul>
        </div>
        <div class="col-md-4 mb-xs-2">
          <mpf-select
            label="{label: 'Código tarjeta', required: mainStep.IS_REQUIRED_RT}"
            name="nCodigoTarjeta"
            ng-model="fiveStep.codigoTarjeta"
            text-field="Descripcion"
            value-field="Codigo"
            m-data-source="fiveStep.codigoTarjetas"
            m-Empty-Option="{enterData:true}"
            ng-required="mainStep.IS_REQUIRED_RT">
          </mpf-select>
          <ul class="g-error">
            <li ng-show="frmEmitU5.nCodigoTarjeta.$invalid && !frmEmitU5.nCodigoTarjeta.$pristine">* Este campo es requerido</li>
          </ul>
        </div>
        <div class="col-md-4 mb-xs-2">
          <mpf-input
            label="{label: 'N. Tarjeta', required: mainStep.IS_REQUIRED_RT}"
            name="nTarjeta"
            ng-model="fiveStep.numeroTarjeta"
            ng-maxlength="fiveStep.maxTarjeta"
            ng-required="mainStep.IS_REQUIRED_RT"
            ng-change="onNumeroChange()"
            ng-blur="onNumeroBlur()">
          </mpf-input>
          <ul class="g-error">
            <li ng-show="frmEmitU5.nTarjeta.$invalid && !frmEmitU5.nTarjeta.$pristine">* Este campo es requerido</li>
          </ul>
        </div>
      </div>
      <div class="row" ng-if="isRegistroTarjeta()">
        <!-- Deberia ser un datepicker -->
        <div class="col-md-4 mb-xs-2 no-mb-md">
          <mpf-input
            label="{label: 'Fecha de vencimiento de tarjeta (mm/yyyy)', required: mainStep.IS_REQUIRED_RT}"
            name="nFecha"
            ng-model="fiveStep.fechaTarjeta"
            ng-maxlength="7"
            ng-pattern="pattern"
            ignore-trunc="true"
            ng-required="mainStep.IS_REQUIRED_RT">
          </mpf-input>
          <ul class="g-error">
            <li ng-show="frmEmitU5.nFecha.$invalid && !frmEmitU5.nFecha.$pristine">* Este campo es requerido</li>
          </ul>
        </div>
        <div class="col-md-4">
          <mpf-select
            label="{label: 'Código gestor', required: mainStep.IS_REQUIRED_RT}"
            name="nCodigoGestorTa"
            ng-model="fiveStep.codigoGestorTa"
            text-field="Descripcion"
            value-field="Codigo"
            m-data-source="fiveStep.codigoGestoresTa"
            m-Empty-Option="{enterData:true}"
            ng-required="mainStep.IS_REQUIRED_RT">
          </mpf-select>
          <ul class="g-error">
            <li ng-show="frmEmitU5.nCodigoGestorTa.$invalid && !frmEmitU5.nCodigoGestorTa.$pristine">* Este campo es requerido</li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <div class="g-section-inner">
    <div class="container">
      <div class="row">
        <div class="col-md-12">
          <h2 class="g-sub-title">Archivo cargomático <span ng-hide="isRequiredFile()">(opcional)</span></h2>
        </div>
      </div>
      <div class="row">
        <div class="col-md-4 col-sm-6 g-text-center-xs">

          <div class="clearfix g-box fz14 gBgcGray5 pt-xs-2 pb-xs-2" ng-if="fiveStep.selectLoadFile">
            <div class="col-md-12 mb-xs-1">
              <span>Cargar documento escaneado</span>
            </div>
            <div class="col-md-10 col-md-offset-1">
              <label class="g-btn g-btn-white second-design block g-btn-input-file">
                <span class="g-icon">
                  <span class="icon icon-plus ico-mapfre_56_visitasalmedico"></span>
                  <span>Escoger archivo</span>
                </span>
                <input type="file" data-show-preview="false" id="iLoadFile" name="nLoadFile" file-model="fiveStep.fmLoadFile" ng-model="fiveStep.mLoadFile" ng-required="isRequiredFile()" onchange="angular.element(this).scope().fnChangeLoadFile()">
              </label>
              <ul class="g-error">
                <li ng-show="frmEmitU5.nLoadFile.$invalid && !frmEmitU5.nLoadFile.$pristine">* Seleccione un archivo</li>
                <!-- ".JPEG", ".MSG", ".WAVE", ".PDF", ".MSW12" -->
              </ul>
            </div>
          </div>

          <div class="clearfix g-box fz14 gBgcGray5 pt-xs-2 pb-xs-2" ng-if="!fiveStep.selectLoadFile">
            <div class="col-md-12 mb-xs-0-5">
              <span class="ico-mapfre_314_archivos gnIcon-lg gCGray3"></span>
            </div>
            <div class="col-md-12">
              <b>{{fiveStep.nameLoadFile}}</b>
            </div>
            <div class="col-md-12 mb-xs-1">
              Documento cargado exitosamente
            </div>
            <div class="col-sm-12">
              <label class="g-btn-input-file">
                <span class="g-icon gCGreen1">
                  <span class="icon ico-mapfre_311_arrowRight"></span>
                  <span class="g-link no-uppercase"><b>Volver a cargar documento</b></span>
                </span>
                <input type="file" data-show-preview="false" id="iLoadFile" name="nLoadFile" file-model="fiveStep.fmLoadFile" ng-model="fiveStep.mLoadFile" ng-required="false" onchange="angular.element(this).scope().fnChangeLoadFile()">
              </label>
            </div>
          </div>

        </div>

      </div>
    </div>
  </div>

  <div class="g-section">
    <div class="container">
      <div class="row">
        <div class="col-md-4 col-md-offset-4">
          <a class="g-btn g-btn-verde block"
          ga-click ga-category="'Emisa - Auto'" ga-action="'MPF - Emisión'" ga-label="'Botón: Emitir'" ga-value="'Usado'"
          ng-click="sendEmission()">Emitir Poliza</a>
        </div>
      </div>
      <div class="row">
        <div class="col-md-12">
          <ul class="g-error-service">
            <li ng-show="emitError.value">
              <span class="ico-mapfre_37_informacion ico"></span>{{ emitError.description }}
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</form>
