<div class="second-step">

	<form action="" name="fData">


		<div class="g-section mt-xs-3"  ng-if="!PPJ_PU">
			<div class="container">

				<div class="row">
					<div class="col-md-12">
						<h2 class="g-sub-title g-myd-subtitle">{{firstStep.cotizacion.FlagRentaSegura === 'S' ? 'Datos Bancarios para el Pago de Renta' : 'Datos del Gestor de Cobro'}}</h2>
					</div>
				</div>
				<div class="row" ng-if="firstStep.cotizacion.FlagRentaSegura !== 'S'">
					<div class="col-md-4">
						<div class="row">
							<div class="col-md-6 mb-xs-2">
								<m-radio
									label="{label: 'Registro de cuenta'}"
									name="nRegistro"
									ng-model="data.registro"
									value="C"
									ng-click="clearCollectionManager(data.registro, true)">
								</m-radio>
							</div>
							<div class="col-md-6 mb-xs-2">
								<m-radio
									label="{label: 'Registro de tarjeta'}"
									name="nRegistro"
									ng-model="data.registro"
									value="T"
									ng-click="clearCollectionManager(data.registro, true)">
								</m-radio>
							</div>
						</div>
					</div>
				</div>
				<div class="row" ng-if="data.registro=='C'">
					<div class="col-md-4 mb-xs-2">
						<mpf-select
							label="{label: 'Entidad', required: data.IS_REQUIRED_RC_RENTA_SEGURA}"
							name="nEntidad"
							ng-model="data.entidad"
							text-field="Descripcion"
							value-field="Codigo"
							m-data-source="entidades"
							m-Empty-Option="{enterData:true}"
							ng-change="onEntidadChange(data.entidad)"
							ng-required="data.IS_REQUIRED_RC_RENTA_SEGURA">
						</mpf-select>
						<ul class="g-error">
							<li ng-show="fData.nEntidad.$invalid && !fData.nEntidad.$pristine">* Este campo es requerido</li>
						</ul>
					</div>
					<div class="col-md-4 mb-xs-2">
						<mpf-input
							label="{label: 'Oficina', required: data.IS_REQUIRED_RC}"
							name="nOficina"
							ng-model="data.oficina"
							ng-required="data.IS_REQUIRED_RC"
							ng-disabled="true">
						</mpf-input>
						<ul class="g-error">
            	<li ng-show="fData.nOficina.$invalid && !fData.nOficina.$pristine">* Este campo es requerido</li>
          	</ul>
					</div>
					<div class="col-md-4 mb-xs-2">
						<mpf-select
							label="{label: 'Tipo de cuenta', required: data.IS_REQUIRED_RC_RENTA_SEGURA}"
							name="nTipoCuenta"
							ng-model="data.tipoCuenta"
							text-field="Descripcion"
							value-field="Codigo"
							m-data-source="tipoCuentas"
							m-Empty-Option="{enterData:true}"
							ng-required="data.IS_REQUIRED_RC_RENTA_SEGURA">
						</mpf-select>
						<ul class="g-error">
							<li ng-show="fData.nTipoCuenta.$invalid && !fData.nTipoCuenta.$pristine">* Este campo es requerido</li>
						</ul>
					</div>
				</div>
				<div class="row" ng-if="data.registro=='C'">
					<div class="col-md-4 mb-xs-2">
						<mpf-select
							label="{label: 'Moneda', required: data.IS_REQUIRED_RC_RENTA_SEGURA}"
							name="nMoneda"
							ng-model="data.moneda"
							text-field="Descripcion"
							value-field="Codigo"
							m-data-source="monedas"
							m-Empty-Option="{enterData:true}"
							ng-required="data.IS_REQUIRED_RC_RENTA_SEGURA">
						</mpf-select>
						<ul class="g-error">
							<li ng-show="fData.nMoneda.$invalid && !fData.nMoneda.$pristine">* Este campo es requerido</li>
						</ul>
					</div>
					<div class="col-md-4 mb-xs-2">
						<mpf-input
							label="{label: 'Cta calcular', required: data.IS_REQUIRED_RC_RENTA_SEGURA}"
							name="nCalcular"
							ng-model="data.ctaCalcular"
							ng-maxlength="data.maxCuenta"
							mpf-validation="onlyNumber"
							ng-required="data.IS_REQUIRED_RC_RENTA_SEGURA"
							ng-blur="onCtaCalcular(data.ctaCalcular)">
						</mpf-input>
						<ul class="g-error">
							<li ng-show="fData.nCalcular.$invalid && !fData.nCalcular.$pristine">* Este campo es requerido</li>
						</ul>
					</div>
					<div class="col-md-4 mb-xs-2">
						<mpf-input
							label="{label: 'Cuenta', required: data.IS_REQUIRED_RC}"
							name="nCuenta"
							ng-model="data.cuenta"
							mpf-validation="onlyLetterNumber"
							ng-maxlength="100"
							ng-required="data.IS_REQUIRED_RC"
							ng-disabled="true">
						</mpf-input>
						<ul class="g-error">
							<li ng-show="fData.nCuenta.$invalid && !fData.nCuenta.$pristine">* Este campo es requerido</li>
						</ul>
					</div>
				</div>
				<div class="row" ng-if="data.registro=='C'">
					<div class="col-md-4">
						<mpf-select
							label="{label: 'Código gestor', required: data.IS_REQUIRED_RC_RENTA_SEGURA}"
							name="nCodigoGestorEn"
							ng-model="data.codigoGestorEn"
							m-data-source="data.codigoGestoresEn"
							text-field="Descripcion"
							value-field="Codigo"
							m-Empty-Option="{enterData:true}"
							ng-required="data.IS_REQUIRED_RC_RENTA_SEGURA" >
						</mpf-select>
						<ul class="g-error">
							<li ng-show="fData.nCodigoGestorEn.$invalid && !fData.nCodigoGestorEn.$pristine">* Este campo es requerido</li>
						</ul>
					</div>
				</div>


				<div class="row" ng-if="data.registro=='T'">
					<div class="col-md-4 mb-xs-2">
						<mpf-select
							label="{label: 'Tipo de tarjeta', required: data.IS_REQUIRED_RT}"
							name="nTipoTarjeta"
							ng-model="data.tipoTarjeta"
							text-field="Descripcion"
							value-field="Codigo"
							m-data-source="tipoTarjetas"
							ng-change="onTipoTarjetaChange(data.tipoTarjeta)"
							m-Empty-Option="{enterData:true}"
							ng-required="data.registro=='T'">
						</mpf-select>
						<ul class="g-error">
							<li ng-show="fData.nTipoTarjeta.$invalid && !fData.nTipoTarjeta.$pristine">* Este campo es requerido</li>
						</ul>
					</div>
					<div class="col-md-4 mb-xs-2">
						<mpf-select
							label="{label: 'Código tarjeta', required: data.IS_REQUIRED_RT}"
							name="nCodigoTarjeta"
							ng-model="data.codigoTarjeta"
							text-field="Descripcion"
							value-field="Codigo"
							m-data-source="data.codigoTarjetas"
							m-Empty-Option="{enterData:true}"
							ng-required="data.IS_REQUIRED_RT">
						</mpf-select>
						<ul class="g-error">
							<li ng-show="fData.nCodigoTarjeta.$invalid && !fData.nCodigoTarjeta.$pristine">* Este campo es requerido</li>
						</ul>
					</div>
					<div class="col-md-4 mb-xs-2">
						<mpf-input
							label="{label: 'N. Tarjeta', required: data.IS_REQUIRED_RT}"
							name="nTarjeta"
							ng-model="data.numeroTarjeta"
							ng-maxlength="data.maxTarjeta"
							ng-required="data.IS_REQUIRED_RT"
							ng-change="onNumeroChange()"
							ng-blur="onNumeroBlur()">
						</mpf-input>
						<ul class="g-error">
							<li ng-show="fData.nTarjeta.$invalid && !fData.nTarjeta.$pristine">* Este campo es requerido</li>
						</ul>
					</div>
				</div>
				<div class="row" ng-if="data.registro=='T'">
					<!-- Deberia ser un datepicker -->
					<div class="col-md-4 mb-xs-2 no-mb-md">
						<mpf-input
							label="{label: 'Fecha de vencimiento de tarjeta (mm/yyyy)', required: data.IS_REQUIRED_RT}"
							name="nFecha"
							ng-model="data.fechaTarjeta"
							ng-maxlength="7"
							ng-pattern="pattern"
							ignore-trunc="true"
							ng-required="data.IS_REQUIRED_RT">
						</mpf-input>
						<ul class="g-error">
							<li ng-show="fData.nFecha.$invalid && !fData.nFecha.$pristine">* Este campo es requerido</li>
						</ul>
					</div>
					<div class="col-md-4">
						<mpf-select
							label="{label: 'Código gestor', required: data.IS_REQUIRED_RT}"
							name="nCodigoGestorTa"
							ng-model="data.codigoGestorTa"
							text-field="Descripcion"
							value-field="Codigo"
							m-data-source="data.codigoGestoresTa"
							m-Empty-Option="{enterData:true}"
							ng-required="data.IS_REQUIRED_RT">
						</mpf-select>
						<ul class="g-error">
							<li ng-show="fData.nCodigoGestorTa.$invalid && !fData.nCodigoGestorTa.$pristine">* Este campo es requerido</li>
						</ul>
					</div>
				</div>
				<div class="row mt-xs-4 h-myd--block h-oim-none" ng-if="false">
					<div class="col-sm-6 col-md-4 col-sm-offset-3 col-md-offset-4">
            <a class="g-btn g-btn-verde block">Generar Documento</a>
					</div>
				</div>

			</div>
		</div>

		<div class="g-section mt-xs-3 h-myd--block h-oim-none h-myd-bg--gray4 h-myd-pt--30 h-myd-pb--30"  ng-if="false">
			<div class="container">
				<div class="row">
					<div class="col-xs-12">
						<h2 class="g-sub-title g-myd-subtitle">Datos del gestor de cobro</h2>
					</div>
				</div>
				<ul class="row h-myd-mb--20">
					<li class="col-md-4 g-list-md clearfix cnt-item mb-xs-1 h-myd-pl--0">
						<div class="col-sm-5 item-label">Tipo registro:</div>
						<div class="col-sm-7 item-dato g-text-uppercase">Registro de cuenta</div>
					</li>
					<li class="col-md-4 g-list-md clearfix cnt-item mb-xs-1 h-myd-pl--0">
						<div class="col-sm-5 item-label">Entidad:</div>
						<div class="col-sm-7 item-dato g-text-uppercase">Banco de credito</div>
					</li>
					<li class="col-md-4 g-list-md clearfix cnt-item mb-xs-1 h-myd-pl--0">
						<div class="col-sm-5 item-label">Oficina:</div>
						<div class="col-sm-7 item-dato g-text-uppercase g-text-uppercase">0191</div>
					</li>
					<li class="col-md-4 g-list-md clearfix cnt-item mb-xs-1 h-myd-pl--0">
						<div class="col-sm-5 item-label">Tipo de cuenta:</div>
						<div class="col-sm-7 item-dato g-text-uppercase">Ahorros</div>
					</li>
					<li class="col-md-4 g-list-md clearfix cnt-item mb-xs-1 h-myd-pl--0">
						<div class="col-sm-5 item-label">Moneda:</div>
						<div class="col-sm-7 item-dato g-text-uppercase">Soles</div>
					</li>
					<li class="col-md-4 g-list-md clearfix cnt-item mb-xs-1 h-myd-pl--0">
						<div class="col-sm-5 item-label">Cta calcular:</div>
						<div class="col-sm-7 item-dato g-text-uppercase g-text-uppercase">11111111111111</div>
					</li>
					<li class="col-md-4 g-list-md clearfix cnt-item mb-xs-1 h-myd-pl--0">
						<div class="col-sm-5 item-label">Cuenta:</div>
						<div class="col-sm-7 item-dato g-text-uppercase">20111111XXXXXXXXX</div>
					</li>
					<li class="col-md-4 g-list-md clearfix cnt-item mb-xs-1 h-myd-pl--0">
						<div class="col-sm-5 item-label">Código gestor:</div>
						<div class="col-sm-7 item-dato g-text-uppercase g-text-uppercase">Banco de credito del Perú</div>
					</li>
				</ul>
				<div class="row">
					<div class="col-xs-12">
						Componente de firma
					</div>
				</div>
			</div>
		</div>

		<div class="g-section-inner" ng-if="!PPJ_PU">
			<div class="container">
				<div class="row">
					<div class="col-md-12">
						<h2 class="g-sub-title g-myd-subtitle">Archivo cargomático</h2>
					</div>
				</div>
				<div class="row">
					<div class="col-md-4 col-sm-6 g-text-center-xs">

						<div class="clearfix g-box fz14 gBgcGray5 pt-xs-2 pb-xs-2" ng-if="data.selectLoadFile">
							<div class="col-md-12 mb-xs-1">
								<span>Cargar documento escaneado</span>
							</div>
							<div class="col-md-10 col-md-offset-1">
								<label class="g-btn g-btn-white second-design block g-btn-input-file">
									<span class="g-icon">
										<span class="icon icon-plus ico-mapfre_56_visitasalmedico"></span>
										<span>Escoger archivo</span>
									</span>
									<input type="file" data-show-preview="false" id="iLoadFile" name="nLoadFile" file-model="data.fmLoadFile" ng-model="data.mLoadFile" ng-required="false" onchange="angular.element(this).scope().fnChangeLoadFile()">
								</label>
								<ul class="g-error">
									<li ng-show="fData.nLoadFile.$invalid && !fData.nLoadFile.$pristine">* Seleccione un archivo</li>
								</ul>
							</div>
						</div>

						<div class="clearfix g-box fz14 gBgcGray5 pt-xs-2 pb-xs-2" ng-if="!data.selectLoadFile">
							<div class="col-md-12 mb-xs-0-5">
								<span class="ico-mapfre_314_archivos gnIcon-lg gCGray3"></span>
							</div>
							<div class="col-md-12">
								<b>{{data.nameLoadFile}}</b>
							</div>
							<div class="col-md-12 mb-xs-1">
								Documento cargado exitosamente
							</div>
							<div class="col-sm-12">
								<label class="g-btn-input-file">
									<span class="g-icon gCGreen1">
										<span class="icon ico-mapfre_311_arrowRight"></span>
										<span class="g-link no-uppercase"><b>Volver a cargar documento</b></span>
									</span>
									<input type="file" data-show-preview="false" id="iLoadFile" name="nLoadFile" file-model="data.fmLoadFile" ng-model="data.mLoadFile" ng-required="false" onchange="angular.element(this).scope().fnChangeLoadFile()">
								</label>
							</div>
						</div>

					</div>

				</div>
			</div>
		</div>

		<div class="g-section-inner">
			<div class="container">

				<div class="row">
					<div class="col-md-12">
						<h2 class="g-sub-title g-myd-subtitle">Beneficiarios en caso de muerte</h2>
					</div>
				</div>

				<beneficiarios data="data.dataBeneficiary" num-doc-principal="contrantanteDocNum"></beneficiarios>

			</div>
    </div>


    <!-- ENDOSATARIO -->
    <div class="g-section-inner" ng-if="!data.esRentaSegura">
      <div class="container">
        <div class="row">
          <div class="col-md-12">
            <h2 class="g-sub-title g-myd-subtitle">Endosatario</h2>
          </div>
        </div>
        <div class="row">
          <div class="col-md-12 mb-xs-2">
            <span class="g-label mb-xs-2">Selecciona como deseas buscar al endosatario</span>
            <div class="row">
              <div class="col-md-3">
                <m-radio
                  label="{label: 'No usar endosatario'}"
                  name="nRadioEndosatario"
                  ng-model="data.rEndosatario"
                  value="0"
                  ng-click="clearEndosatarioFields()"
                  ng-required="true"
                ></m-radio>
              </div>
              <div class="col-md-3">
                <m-radio
                  label="{label: 'Buscar endosatario por RUC'}"
                  name="nRadioEndosatario"
                  ng-model="data.rEndosatario"
                  value="1"
                  ng-click="clearEndosatarioFields()"
                  ng-required="true"
                ></m-radio>
              </div>
              <div class="col-md-4">
                <m-radio
                  label="{label: 'Buscar endosatario por nombre'}"
                  name="nRadioEndosatario"
                  ng-model="data.rEndosatario"
                  value="2"
                  ng-click="clearEndosatarioFields()"
                  ng-required="true"
                ></m-radio>
              </div>
            </div>
          </div>
        </div>

        <div class="row" ng-if="data.rEndosatario > 0">
          <div class="col-md-2 mb-xs-2" ng-if="data.rEndosatario == 1 && !data.endosatarioEncontrado">
            <mpf-input
              label="{label: 'RUC del endosatario', required: true}"
              name="nRucEndosatario"
              ng-model="data.mRucEndosatario"
              ng-required="true"
            ></mpf-input>
            <div class="g-error" ng-show="data.noExisteEndosatario">El RUC que ingresaste no existe</div>
          </div>
          <div class="col-md-2 mt-xs-2 h-myd-mt--0" ng-if="data.rEndosatario == 1 && !data.endosatarioEncontrado">
            <a class="g-btn g-btn-green-border block" ng-click="buscarEndosatario(data.mRucEndosatario)">Buscar</a>
          </div>

          <div class="col-md-2 mb-xs-2" ng-if="data.rEndosatario == 1 && data.endosatarioEncontrado">
            <span class="g-placeholder block mb-xs-1">RUC del endosatario*:</span>
            <span class="">{{ data.endosatario.Codigo }} - {{ data.endosatario.Descripcion }}</span>
          </div>
          <div class="col-md-2 mt-xs-2" ng-if="data.rEndosatario == 1 && data.endosatarioEncontrado">
            <a class="g-btn g-btn-transparent block" ng-click="limpiarEndosatario()">Cambiar</a>
          </div>

          <div class="col-md-4 mb-xs-2" ng-if="data.rEndosatario == 2">
						<mp-data-seeker
							name="nEndosatario"
							behavior="{
								label:'Endosatario',
								placeholder:'Busque o seleccione un endosatario ...',
								matchField:'Descripcion',
								enableDataCamelCase: false,
								required:true
							}"
							m-data-source="getAutocompleteEndorseeByName($inputNeed)"
							ng-model="data.endosatario"
							ng-required="true"
						>
							<div ng-bind-html="$item.Descripcion | highlight: $select.search"></div>
						</mp-data-seeker>
            <ul class="g-error">
							<li ng-show="fData.nEndosatario.$invalid && !fData.nEndosatario.$pristine">* Este campo es requerido</li>
						</ul>
          </div>

          <div class="col-md-4 mb-xs-2">
            <m-numeric-textbox
              label="{label: 'Suma endosada', required: true}"
              name="nSumEndosada"
              ng-model="data.sumaEndosada"
              mpf-validation="required"
            ></m-numeric-textbox>
            <ul class="g-error">
							<li ng-show="fData.nSumEndosada.$invalid && !fData.nSumEndosada.$pristine">* Este campo es requerido</li>
						</ul>
          </div>
          <div class="col-md-4 mb-xs-2">
            <div class="input-group g-date-picker">
              <label class="g-placeholder animated">
								Fecha vencimiento de cesión<span>*</span>
							</label>
              <input type="text"
								class="form-control"
								name="nCesionDate"
								ng-model="data.mCesionDate"
                uib-datepicker-popup="{{format}}"
                is-open="popupCesionDate.opened"
                datepicker-options="dateOptions"
                close-text="Close"
								alt-input-formats="altInputFormats"
								ng-required="true"
                readonly
              />
              <span class="input-group-btn">
                <button type="button" class="btn btn-default" ng-click="openCesionDate()"><em class="ico-mapfre_127_calendar3 gnIcon-xsm"></em></button>
              </span>
						</div>
						<ul class="g-error">
							<li ng-show="fData.nCesionDate.$invalid && !fData.nCesionDate.$pristine">* Este campo es obligatorio</li>
						</ul>
          </div>
        </div>
      </div>
    </div>

		<div class="g-section-inner">
			<div class="container">

				<div class="row">
					<div class="col-md-12">
						<h2 class="g-sub-title g-myd-subtitle">Referidos</h2>
					</div>
				</div>

				<div class="row">
					<div class="col-md-4">
						<div class="row">
							<div class="col-md-6 mb-xs-2">
								<m-radio label="{label: 'Si'}" name="nReferido" ng-model="data.breferidos" value="S"></m-radio>
							</div>
							<div class="col-md-6 mb-xs-2">
								<m-radio label="{label: 'No'}" name="nReferido" ng-model="data.breferidos" value="N"></m-radio>
							</div>
						</div>
					</div>
				</div>

				<referidos data="data.referidos" ng-if="data.breferidos == 'S'"></referidos>

			</div>
		</div>

		<div class="g-section">
			<div class="container">
				<div class="row">
					<div class="col-md-4 mb-xs-1">
						<span class="gCGray3">*Campos obligatorios</span>
					</div>
					<div class="col-md-4">
            <a class="g-btn g-btn-verde block" ng-click="nextStep()">Siguiente</a>
					</div>
				</div>
			</div>
		</div>


	</form>

</div>
